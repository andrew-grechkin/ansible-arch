---
- name: Install xorg
  become: true
  pacman:
    name:
      - accountsservice
      - rofi
      - sxhkd
      - xclip
      - xdotool
      - xorg-fonts
      - xorg-fonts-cyrillic
      - xorg-fonts-misc
      - xorg-server
      - xorg-xdpyinfo
      - xorg-xev
      - xorg-xinit
      - xorg-xinput
      - xsel

- name: Install terminal emulator
  become: true
  pacman:
    name:
      - alacritty

- name: Install keyring (needed by many apps)
  become: true
  pacman:
    name: [gnome-keyring, seahorse]

- name: Install xdg
  become: true
  pacman:
    name: [xdg-user-dirs, xdg-utils]

- name: Install themes
  become: true
  pacman:
    name: [archlinux-wallpaper, papirus-icon-theme]
# - adapta-gtk-theme
# #arc-gtk-theme arc-icon-theme arc-solid-gtk-theme
# #gnome-icon-theme gnome-icon-theme-extras gnome-icon-theme-symbolic
# gnome-themes-extra
# xdg-user-dirs-update
# xdg-user-dirs-gtk-update

- name: Update keyboard mapping
  become: true
  shell: localectl set-x11-keymap us,ru pc105 , grp:lctrl_lshift_toggle --no-convert

- name: Install fonts
  become: true
  pacman:
    name: [opendesktop-fonts, powerline-fonts, ttf-dejavu, ttf-font-awesome, ttf-liberation]

- name: Install additional fonts
  become: true
  pacman:
    name:
      - noto-fonts-cjk
      - adobe-source-han-sans-cn-fonts
      - adobe-source-han-sans-jp-fonts
      - adobe-source-han-sans-kr-fonts
      - ttf-indic-otf

- name: Install emoji support
  become: true
  pacman:
    name: [noto-fonts-emoji, unicode-emoji, ttf-joypixels]

- name: Install i3
  become: true
  pacman:
    name: [i3-gaps, i3lock, picom, feh]
    # - autorandr
    # - bc
    # - playerctl
    # - volumeicon
    # - xfce4-i3-workspaces-plugin-git

- name: Allow RSYNC for new super user without SUDO password
  become: true
  lineinfile:
    path: /etc/sudoers
    state: present
    insertafter: ^%sudo
    line: "{{ lookup('env','USER') }} ALL=NOPASSWD: /usr/bin/rsync"

- name: Copy configs
  become: true
  synchronize:
    src: X11
    dest: /etc/
    archive: false
    compress: false
    recursive: true

- name: Disallow RSYNC for new super user without SUDO password
  become: true
  lineinfile:
    path: /etc/sudoers
    state: absent
    line: "{{ lookup('env','USER') }} ALL=NOPASSWD: /usr/bin/rsync"
